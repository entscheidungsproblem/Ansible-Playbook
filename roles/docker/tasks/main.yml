---
- name: Docker installation
  become: true   
  become_method: sudo
  xbps:
    name:
      - docker 
      - docker-compose
      - python-docker
      - python3-docker
    state: present

- name: Docker-py installation (python2)
  become: true   
  become_method: sudo
  pip:
    executable: pip2
    name: docker-py 

- name: Docker-py installation (python3)
  become: true   
  become_method: sudo
  pip:
    executable: pip3
    name: docker-py 

- name: Create docker group
  group:
    name: docker
    gid: "{{ gid }}"

- name: Add user to docker group
  user:
    name: "{{ ansible_env.USER }}"
    groups: docker

- name: Set environment variables
  template:
    src: environment.j2
    dest: /etc/environment
    owner: root
    group: root
    mode: 0644